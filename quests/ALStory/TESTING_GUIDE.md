# Тестирование квестов AL Story

## Общая информация
- ID мода: `alstory`
- Зависимость: `alegacyvsquest`

---

## Квест 1: Последний вздох Ордена Обреченных (last_breath_main)

### Как начать
1. Найти NPC Элрик (координаты: -505 250 -93)
2. Поговорить с Элриком → принять квест

### Что тестировать

#### Получение предметов
- [ ] **Шлем** - добывается в Башне Ордена (1435 250 -673) с босса Эйдолон
- [ ] **Нагрудник** - добывается в Лагере Кровавой Длани (2090 250 -3753) с босса Вождь с Руками-Клещами
- [ ] **Поножи** - добываются в Деревне У Погибшего Камня (-1243 180 -12736) от Иллы

#### Проверка целей
- [ ] При получении шлема → цель "helmet" отмечается выполненной
- [ ] При получении нагрудника → цель "chestplate" отмечается выполненной
- [ ] При получении поножей → цель "leggings" отмечается выполненной
- [ ] После сбора 3 частей → появляется цель "necropolis_complete"

#### Завершение квеста
- [ ] После выполнения квеста "Суд Некрополя" (necropolis_judgment) возвращаемся к Элрику
- [ ] Элрик забирает все 3 части доспехов
- [ ] Выдаётся книга "Легенда о Треснувшем Колоколе"
- [ ] Звук завершения
- [ ] Запись в журнале

---

## Квест 2: Сердце деревни (village_heart)

### Как начать
1. Прийти в Деревню У Погибшего Камня (-1243 180 -12736)
2. Поговорить со Старостой Генрихом → принять квест

### Что тестировать

#### Получение предметов при старте
- [ ] Получен Ключ хранителя (alstory-keepers-key)
- [ ] Получен Ритуальный осколок (alstory-ritual-crystalbreaker)

#### Прохождение квеста
- [ ] Поговорить с Генрихом → цель "heinrich" выполнена
- [ ] Прийти в деревню → цель "village" выполнена
- [ ] Уничтожить кристалл 1 (подвал мельницы)
- [ ] Уничтожить кристалл 2 (погреб кузницы)
- [ ] Уничтожить кристалл 3 (чердак школы)
- [ ] После уничтожения 3 кристаллов → цель "crystals" выполнена

#### Финал
- [ ] Поговорить с Иллой (дом с засохшей розой на ставне)
- [ ] Получить поножи (quest:leggings_of_the_doomed)
- [ ] Квест завершается

---

## Квест 3: Суд Некрополя (necropolis_judgment)

### Как начать
Автоматически после завершения village_heart

### Что тестировать

#### Прохождение
- [ ] Прийти в Некрополь Королей (-2727 250 -10000)
- [ ] Поговорить с Лорэном → цель "loran" выполнена
- [ ] Победить Лорэна (босс) → цель "loranboss" выполнена
- [ ] Устанавливается глобальная переменная `necropolis_judgment_complete = 1`

#### Возвращение к Элрику
- [ ] Вернуться к Элрику → цель "elrikreturn" выполнена
- [ ] Квест завершается

---

## Общие проверки

### Диалоги
- [ ] Элрик: правильные ответы на "Кто ты?", "Что случилось?"
- [ ] Элрик: появляется опция "Я нашёл Лорэна" после убийства босса
- [ ] Генрих: правильные ответы про Иллу и деревню
- [ ] Илла: появляется опция "Я ослабил ритуал" после уничтожения кристаллов
- [ ] Лорэн: правильные ответы про Иллу и суд

### Предметы
- [ ] Все предметы нельзя выбросить (blockDrop: true)
- [ ] Все предметы нельзя потерять при смерти (blockDeath: true)
- [ ] Предметы брони нельзя надеть (blockEquip: true)

### Журнал
- [ ] Записи добавляются при взятии квестов
- [ ] Записи обновляются при выполнении целей
- [ ] Финальные записи появляются при завершении

---

## Координаты для тестирования

| Локация | Координаты |
|---------|------------|
| Элрик (хижина на холме) | -505 250 -93 |
| Башня Ордена | 1435 250 -673 |
| Лагерь Кровавой Длани | 2090 250 -3753 |
| Деревня У Погибшего Камня | -1243 180 -12736 |
| Некрополь Королей | -2727 250 -10000 |

---

## Порядок тестирования

1. **Начать с village_heart** - поговорить с Генрихом, пройти деревню
2. **После village_heart** - принять necropolis_judgment, убить Лорэна
3. **Вернуться к Элрику** - принять last_breath_main
4. **Собрать все 3 части брони** в любом порядке
5. **Проверить завершение** - вернуться к Элрику после necropolis

---

## Известные проблемы (если появятся)

- Если цель не отмечается → проверить ID предмета в hasitem
- Если диалог не открывается → проверить dialogue файл и переменные
- Если предметы не выдаются → проверить itemconfig.json
- Если квест не принимается → проверить predecessor зависимости
